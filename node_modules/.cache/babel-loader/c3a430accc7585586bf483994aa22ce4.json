{"ast":null,"code":"import _regeneratorRuntime from\"/home/bogdan/GIT/react/goit-react-hw-04-movies/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/bogdan/GIT/react/goit-react-hw-04-movies/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/home/bogdan/GIT/react/goit-react-hw-04-movies/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/bogdan/GIT/react/goit-react-hw-04-movies/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/bogdan/GIT/react/goit-react-hw-04-movies/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/bogdan/GIT/react/goit-react-hw-04-movies/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import MovieList from'../../movieList/MovieList';import axios from'axios';import qs from'query-string';import style from'./MoviesPage.module.scss';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var MoviesPage=/*#__PURE__*/function(_Component){_inherits(MoviesPage,_Component);var _super=_createSuper(MoviesPage);function MoviesPage(){var _this;_classCallCheck(this,MoviesPage);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={total_pages:1,query:'',movies:[]};_this.onQuerySearch=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(query){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get(\"\".concat(process.env.REACT_APP_DATA_BASEURL,\"/search/movie?api_key=\").concat(process.env.REACT_APP_KEY,\"&query=\").concat(query));case 2:res=_context.sent;_this.setState({movies:res.data.results,total_pages:res.data.total_pages});case 4:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();_this.handlerInput=function(e){if(!e.target.value){_this.setState({total_pages:1});}_this.setState({query:e.target.value});};_this.handlerSubmit=function(e){e.preventDefault();_this.props.history.push({pathname:_this.props.location.pathname,search:\"query=\".concat(_this.state.query)});};return _this;}_createClass(MoviesPage,[{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps){if(prevProps.location.search!==this.props.location.search){this.onQuerySearch(this.state.query);}}},{key:\"componentDidMount\",value:function componentDidMount(){var _qs$parse=qs.parse(this.props.location.search),query=_qs$parse.query;if(query){this.onQuerySearch(query);}}},{key:\"render\",value:function render(){var _this$state=this.state,query=_this$state.query,movies=_this$state.movies,total_pages=_this$state.total_pages;return/*#__PURE__*/_jsxs(\"div\",{className:\"formBox\",children:[/*#__PURE__*/_jsxs(\"form\",{className:style.formMovie,onSubmit:this.handlerSubmit,children:[/*#__PURE__*/_jsx(\"input\",{className:\"inputMovie\",id:\"standard-search\",label:\"Search field\",type:\"search\",autoComplete:\"off\",autoFocus:true,placeholder:\"movie name\",\"aria-label\":\"Search\",value:query,onChange:this.handlerInput}),/*#__PURE__*/_jsx(\"button\",{variant:\"outlined\",color:\"primary\",className:\"buttonMovie\",type:\"submit\",children:\"Search\"})]}),/*#__PURE__*/_jsx(MovieList,{movies:this.state.movies})]});}}]);return MoviesPage;}(Component);export{MoviesPage as default};","map":{"version":3,"sources":["/home/bogdan/GIT/react/goit-react-hw-04-movies/src/components/pages/moviesPage/MoviesPage.js"],"names":["React","Component","MovieList","axios","qs","style","MoviesPage","state","total_pages","query","movies","onQuerySearch","get","process","env","REACT_APP_DATA_BASEURL","REACT_APP_KEY","res","setState","data","results","handlerInput","e","target","value","handlerSubmit","preventDefault","props","history","push","pathname","location","search","prevProps","parse","formMovie"],"mappings":"28BAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,KAAiC,OAAjC,CACA,MAAOC,CAAAA,SAAP,KAAsB,2BAAtB,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,EAAP,KAAe,cAAf,CACA,MAAOC,CAAAA,KAAP,KAAkB,0BAAlB,C,2FAEqBC,CAAAA,U,2UACnBC,K,CAAQ,CACNC,WAAW,CAAE,CADP,CAENC,KAAK,CAAE,EAFD,CAGNC,MAAM,CAAE,EAHF,C,OAkBRC,a,0FAAgB,iBAAMF,KAAN,gJACIN,CAAAA,KAAK,CAACS,GAAN,WACbC,OAAO,CAACC,GAAR,CAAYC,sBADC,kCAC8CF,OAAO,CAACC,GAAR,CAAYE,aAD1D,mBACiFP,KADjF,EADJ,QACRQ,GADQ,eAKd,MAAKC,QAAL,CAAc,CACZR,MAAM,CAAEO,GAAG,CAACE,IAAJ,CAASC,OADL,CAEZZ,WAAW,CAAES,GAAG,CAACE,IAAJ,CAASX,WAFV,CAAd,EALc,sD,qEAWhBa,Y,CAAe,SAAAC,CAAC,CAAI,CAClB,GAAI,CAACA,CAAC,CAACC,MAAF,CAASC,KAAd,CAAqB,CACnB,MAAKN,QAAL,CAAc,CACZV,WAAW,CAAE,CADD,CAAd,EAGD,CACD,MAAKU,QAAL,CAAc,CAAET,KAAK,CAAEa,CAAC,CAACC,MAAF,CAASC,KAAlB,CAAd,EACD,C,OAEDC,a,CAAgB,SAAAH,CAAC,CAAI,CACnBA,CAAC,CAACI,cAAF,GACA,MAAKC,KAAL,CAAWC,OAAX,CAAmBC,IAAnB,CAAwB,CACtBC,QAAQ,CAAE,MAAKH,KAAL,CAAWI,QAAX,CAAoBD,QADR,CAEtBE,MAAM,iBAAW,MAAKzB,KAAL,CAAWE,KAAtB,CAFgB,CAAxB,EAID,C,wEAtCD,4BAAmBwB,SAAnB,CAA8B,CAC5B,GAAIA,SAAS,CAACF,QAAV,CAAmBC,MAAnB,GAA8B,KAAKL,KAAL,CAAWI,QAAX,CAAoBC,MAAtD,CAA8D,CAC5D,KAAKrB,aAAL,CAAmB,KAAKJ,KAAL,CAAWE,KAA9B,EACD,CACF,C,iCACD,4BAAoB,eACAL,EAAE,CAAC8B,KAAH,CAAS,KAAKP,KAAL,CAAWI,QAAX,CAAoBC,MAA7B,CADA,CACVvB,KADU,WACVA,KADU,CAElB,GAAIA,KAAJ,CAAW,CACT,KAAKE,aAAL,CAAmBF,KAAnB,EACD,CACF,C,sBA8BD,iBAAS,iBACgC,KAAKF,KADrC,CACCE,KADD,aACCA,KADD,CACQC,MADR,aACQA,MADR,CACgBF,WADhB,aACgBA,WADhB,CAEP,mBACE,aAAK,SAAS,CAAC,SAAf,wBACE,cAAM,SAAS,CAAEH,KAAK,CAAC8B,SAAvB,CAAkC,QAAQ,CAAE,KAAKV,aAAjD,wBACE,cACE,SAAS,CAAC,YADZ,CAEE,EAAE,CAAC,iBAFL,CAGE,KAAK,CAAC,cAHR,CAIE,IAAI,CAAC,QAJP,CAKE,YAAY,CAAC,KALf,CAME,SAAS,KANX,CAOE,WAAW,CAAC,YAPd,CAQE,aAAW,QARb,CASE,KAAK,CAAEhB,KATT,CAUE,QAAQ,CAAE,KAAKY,YAVjB,EADF,cAaE,eACE,OAAO,CAAC,UADV,CAEE,KAAK,CAAC,SAFR,CAGE,SAAS,CAAC,aAHZ,CAIE,IAAI,CAAC,QAJP,oBAbF,GADF,cAuBE,KAAC,SAAD,EAAW,MAAM,CAAE,KAAKd,KAAL,CAAWG,MAA9B,EAvBF,GADF,CA2BD,C,wBA5EqCT,S,SAAnBK,U","sourcesContent":["import React, { Component } from 'react';\nimport MovieList from '../../movieList/MovieList';\nimport axios from 'axios';\nimport qs from 'query-string';\nimport style from './MoviesPage.module.scss';\n\nexport default class MoviesPage extends Component {\n  state = {\n    total_pages: 1,\n    query: '',\n    movies: [],\n  };\n\n  componentDidUpdate(prevProps) {\n    if (prevProps.location.search !== this.props.location.search) {\n      this.onQuerySearch(this.state.query);\n    }\n  }\n  componentDidMount() {\n    const { query } = qs.parse(this.props.location.search);\n    if (query) {\n      this.onQuerySearch(query);\n    }\n  }\n\n  onQuerySearch = async query => {\n    const res = await axios.get(\n      `${process.env.REACT_APP_DATA_BASEURL}/search/movie?api_key=${process.env.REACT_APP_KEY}&query=${query}`,\n    );\n\n    this.setState({\n      movies: res.data.results,\n      total_pages: res.data.total_pages,\n    });\n  };\n\n  handlerInput = e => {\n    if (!e.target.value) {\n      this.setState({\n        total_pages: 1,\n      });\n    }\n    this.setState({ query: e.target.value });\n  };\n\n  handlerSubmit = e => {\n    e.preventDefault();\n    this.props.history.push({\n      pathname: this.props.location.pathname,\n      search: `query=${this.state.query}`,\n    });\n  };\n\n  render() {\n    const { query, movies, total_pages } = this.state;\n    return (\n      <div className=\"formBox\">\n        <form className={style.formMovie} onSubmit={this.handlerSubmit}>\n          <input\n            className=\"inputMovie\"\n            id=\"standard-search\"\n            label=\"Search field\"\n            type=\"search\"\n            autoComplete=\"off\"\n            autoFocus\n            placeholder=\"movie name\"\n            aria-label=\"Search\"\n            value={query}\n            onChange={this.handlerInput}\n          />\n          <button\n            variant=\"outlined\"\n            color=\"primary\"\n            className=\"buttonMovie\"\n            type=\"submit\"\n          >\n            Search\n          </button>\n        </form>\n        <MovieList movies={this.state.movies}></MovieList>\n      </div>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}